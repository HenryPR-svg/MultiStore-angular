<!-- NAVBAR -->
<header class="navbar">
  <div class="logo">{{ title }}</div>

  <input
    type="text"
    class="nav-search"
    placeholder="Buscar productos..."
    [(ngModel)]="searchTerm"
  />

  <button class="cart-btn" (click)="openCart()">
    üõí Carrito {{ formatCurrency(cartService.getTotal()) }}
  </button>
</header>

<!-- SLIDER -->
<section class="slider">
  <button class="nav-btn" (click)="prevSlide()">‚Äπ</button>

  <div class="slide">
    <img [src]="sliderImages[currentSlide]" alt="Promoci√≥n" />

    <div class="slide-info">
  <h2>Todo lo que necesitas en un solo lugar</h2>
  <p>Ropa, accesorios, tecnolog√≠a y mucho m√°s con las mejores ofertas de MultiStore.</p>
</div>

  </div>

  <button class="nav-btn" (click)="nextSlide()">‚Ä∫</button>
</section>

<!-- FILTROS -->
<div class="filters">
  <div class="filter-group">
    <label for="category">
      Productos de la categor√≠a:
      <strong>
        {{ selectedCategory === 'Todos' ? 'Todas las categor√≠as' : selectedCategory }}
      </strong>
    </label>

    <select
      id="category"
      [(ngModel)]="selectedCategory"
      (change)="onCategoryChange()"
    >
      <option *ngFor="let cat of categories" [value]="cat">
        {{ cat }}
      </option>
    </select>
  </div>

  <div class="filter-group">
    <input
      type="text"
      class="search-input"
      placeholder="Buscar producto por nombre..."
      [(ngModel)]="searchTerm"
    />
  </div>
</div>

<!-- LISTA DE PRODUCTOS -->
<section class="products">
  <div class="product-card" *ngFor="let product of filteredProducts">
    <img [src]="product.image" [alt]="product.title" />
    <h3>{{ product.title }}</h3>
    <p class="price">{{ formatCurrency(product.price) }}</p>
    <button class="btn primary" (click)="openProduct(product)">Detalles</button>
  </div>

  <p *ngIf="!filteredProducts.length && !loadingProducts">
    No se encontraron productos con ese criterio.
  </p>
</section>

<!-- MODAL DE PRODUCTO -->
<div class="modal-backdrop" *ngIf="showProductModal">
  <div class="modal">
    <div class="modal-header">
      <h2>{{ selectedProduct?.title }}</h2>
      <button class="close-btn" (click)="closeProductModal()">√ó</button>
    </div>

    <div class="modal-body" *ngIf="selectedProduct">
      <img class="modal-img" [src]="selectedProduct.image" [alt]="selectedProduct.title" />
      <p class="modal-price">{{ formatCurrency(selectedProduct.price) }}</p>
      <p>{{ selectedProduct.description }}</p>
      <p><strong>Categor√≠a:</strong> {{ selectedProduct.category }}</p>

      <div class="qty-container">
        <label for="qty">Cantidad:</label>
        <input
          id="qty"
          type="number"
          min="1"
          [(ngModel)]="quantityToAdd"
        />
      </div>

      <span class="success" *ngIf="successMessage">{{ successMessage }}</span>
    </div>

    <div class="modal-footer">
      <button class="btn secondary" (click)="closeProductModal()">Cancelar</button>
      <button class="btn primary" (click)="addSelectedToCart()">Agregar</button>
    </div>
  </div>
</div>

<!-- MODAL DEL CARRITO -->
<div class="modal-backdrop" *ngIf="showCartModal">
  <div class="modal wide">
    <div class="modal-header">
      <h2>Carrito de compra</h2>
      <button class="close-btn" (click)="closeCart()">√ó</button>
    </div>

    <div class="modal-body">
      <table
        class="cart-table"
        *ngIf="cartService.getItems().length; else emptyCart"
      >
        <thead>
          <tr>
            <th>Producto</th>
            <th>Precio</th>
            <th>Cantidad</th>
            <th>Subtotal</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of cartService.getItems()">
            <td>{{ item.product.title }}</td>
            <td>{{ formatCurrency(item.product.price) }}</td>
            <td>{{ item.quantity }}</td>
            <td>{{ formatCurrency(item.product.price * item.quantity) }}</td>
          </tr>
        </tbody>
      </table>

      <ng-template #emptyCart>
        <p>Tu carrito est√° vac√≠o.</p>
      </ng-template>
    </div>

    <div class="modal-footer modal-footer-cart">
      <div class="cart-total-label">
        Total: <strong>{{ formatCurrency(cartService.getTotal()) }}</strong>
      </div>
      <div class="cart-actions">
        <button class="btn secondary" (click)="clearCart()">Vaciar carrito</button>
        <button class="btn secondary" (click)="closeCart()">Cerrar</button>
        <button class="btn primary" (click)="pay()">Pagar</button>
      </div>
    </div>
  </div>
</div>
